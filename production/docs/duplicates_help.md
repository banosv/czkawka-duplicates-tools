CZKAWKA DUPLICATE FILE ANALYSIS - HELP GUIDE
===============================================

OVERVIEW
========
This spreadsheet is designed to work with Czkawka duplicate analysis CSV files generated by the czkawka_to_table.sh script. It provides enhanced file management capabilities with direct file manager integration.

GETTING STARTED
===============

1. IMPORT YOUR DATA
-------------------
1. Generate CSV data using the companion scripts:
   ```bash
   ./czkawkaDupFind.sh ~/Documents duplicates
   ./czkawka_to_table.sh duplicates.json ~/Documents duplicates.csv
   ```
2. Copy entire CSV contents (Ctrl+A, Ctrl+C in text editor)
3. Paste directly into 'duplicates' sheet starting at cell A1 (Ctrl+V)
4. Data will auto-align with pre-formatted columns

### 2. ENABLE MACROS
- **Security Settings:** Tools → Options → LibreOffice → Security → Macro Security
- **Set to:** Medium or Low (or add this file path to trusted locations)
- **Required for:** File manager integration and quick actions

### 3. SETUP KEYBOARD SHORTCUTS
- **Access:** Tools → Customize → Keyboard
- **Assign F3 to:** OpenInFileManagerFromActiveCell
- **Assign Ctrl+3 to:** MarkKeepOriginal
- **Assign Ctrl+4 to:** MarkKeepDuplicate
- **Assign Ctrl+6 to:** MarkNeedsReview
- **Assign Ctrl+7 to:** ShowStatistics
- **Assign Ctrl+8 to:** ClearDecisions
- **Assign Ctrl+9 to:** FilterByAction

---

## SPREADSHEET LAYOUT

### COLUMN STRUCTURE (One Row Per Duplicate Relationship)
| Column | Name | Description | Example |
|--------|------|-------------|---------|
| **A** | OriginalFolder | Path to folder containing original file | `/home/user/Documents/Projects` |
| **B** | OriginalFile | Filename of original file | `important_report.pdf` |
| **C** | DuplicateFolder | Path to folder containing duplicate | `/home/user/Downloads` |
| **D** | DuplicateFile | Filename of duplicate file | `important_report.pdf` |
| **E** | Size | File size in bytes | `2048576` |
| **F** | Hash | File hash for verification | `abc123def456...` |
| **G** | Keep_Original | Decision: keep original file | `YES/NO/REVIEW` |
| **H** | Keep_Duplicate | Decision: keep duplicate file | `YES/NO/REVIEW` |
| **I** | Action | Recommended action | `DELETE_DUPLICATE` |

### DATA FORMAT EXPLANATION
- **One Row = One Duplicate Relationship**
- Files with multiple duplicates appear in multiple rows:
  ```
  Row 1: Documents/report.pdf → Downloads/report.pdf
  Row 2: Documents/report.pdf → Backup/report_backup.pdf
  Row 3: Documents/report.pdf → Archive/old_report.pdf
  ```

---

## FILE MANAGER INTEGRATION

### SUPPORTED FILE MANAGERS
The macro automatically detects and uses available file managers:
1. **Krusader** - Opens dual panes with both locations
2. **Nemo** - Opens both locations in separate tabs
3. **Fallback** - Uses system default file manager in separate windows

### HOW TO USE
1. **Click** on any cell in columns A, B, C, or D (folder paths or filenames)
2. **Press F3** (or your assigned shortcut)
3. **Result:** File manager opens showing both original and duplicate locations

### REQUIREMENTS
- **Nemo:** `sudo apt install nemo`
- **Krusader:** `sudo apt install krusader` (optional, for dual-pane view)
- **Either file manager must be in system PATH**

---

## DUPLICATE MANAGEMENT WORKFLOW

### ANALYSIS PHASE
1. **Import CSV data** from czkawka_to_table.sh output
2. **Sort by size** (Column E) to prioritize large duplicates
3. **Filter by folders** to focus on specific locations
4. **Use F3** to examine files directly in file manager

### DECISION PHASE
Use these quick action macros:
- **Ctrl+3: MarkKeepOriginal** - Keep file in original location, mark duplicate for deletion
- **Ctrl+4: MarkKeepDuplicate** - Keep duplicate, mark original for deletion  
- **Ctrl+6: MarkNeedsReview** - Mark both files for later review
- **Ctrl+8: ClearDecisions** - Reset decisions for selected rows

### VISUAL INDICATORS
- **Green cells:** Files marked to keep
- **Red cells:** Films marked for deletion
- **Yellow cells:** Files needing review
- **Column I (Action):** Shows recommended action

### EXECUTION PHASE
After making decisions:
1. **Filter by Action column** to see files marked for deletion
2. **Export decision list** for batch processing scripts
3. **Manually verify** before actual deletion
4. **Use file manager integration** for final confirmation

---

## ADVANCED FEATURES

### FILTERING & SORTING
- **AutoFilter enabled** on all columns
- **Click column headers** to sort data
- **Use dropdown arrows** to filter specific values
- **Common filters:**
  - Size > 1MB (large files first)
  - Specific duplicate folders
  - Files with certain extensions

### STATISTICS & ANALYSIS
- **Ctrl+7: ShowStatistics** - View comprehensive decision progress report
- **Count duplicates:** Use subtotal functions on filtered data
- **Calculate space savings:** Sum file sizes of files marked for deletion
- **Identify patterns:** Group by folder paths to see duplication hotspots

### BATCH OPERATIONS
- **Select multiple rows** for bulk decision marking
- **Use Ctrl+8: ClearDecisions** to reset multiple rows at once
- **Use Ctrl+9: FilterByAction** to apply AutoFilter for decision analysis
- **Export filtered results** for external processing

---

## KEYBOARD SHORTCUTS REFERENCE

| Key | Action | Description |
|-----|--------|-------------|
| **F3** | Open in File Manager | Opens both original and duplicate locations |
| **Ctrl+3** | Keep Original | Marks original file to keep, duplicate to delete |
| **Ctrl+4** | Keep Duplicate | Marks duplicate file to keep, original to delete |
| **Ctrl+6** | Mark for Review | Marks both files for later review |
| **Ctrl+7** | Show Statistics | Displays decision progress and summary |
| **Ctrl+8** | Clear Decisions | Resets decision markings for selected rows |
| **Ctrl+9** | Filter by Action | Applies AutoFilter for decision analysis |
| **Ctrl+F** | Filter | Opens AutoFilter interface |
| **Ctrl+A** | Select All | Selects all data for bulk operations |

---

## TROUBLESHOOTING

### COMMON ISSUES

**Macro doesn't work:**
- Check macro security settings (Tools → Options → Security)
- Verify keyboard shortcut assignment
- Ensure file manager is installed

**F3 shows error:**
- Verify all four columns (A, B, C, D) contain data
- Check file/folder paths are valid
- Ensure selected cell is in correct row

**CSV import issues:**
- Use correct CSV format from czkawka_to_table.sh
- Paste starting at cell A1
- Ensure no extra headers or formatting

**File manager doesn't open:**
- Install Nemo: `sudo apt install nemo`
- Install Krusader: `sudo apt install krusader` (optional)
- Check if files/folders still exist
- Verify paths don't contain special characters

### PERFORMANCE TIPS
- **Large datasets:** Filter before applying bulk operations
- **Memory usage:** Close other LibreOffice documents
- **Speed:** Use keyboard shortcuts instead of mouse clicks

---

## INTEGRATION WITH COMPANION SCRIPTS

### WORKFLOW SEQUENCE
```bash
# 1. Scan for duplicates
./czkawkaDupFind.sh ~/Documents duplicates_scan

# 2. Convert to structured CSV
./czkawka_to_table.sh duplicates_scan.json ~/Documents duplicates.csv

# 3. Analyze in this spreadsheet
libreoffice --calc duplicates.ods
# (Import duplicates.csv data)

# 4. Make decisions using macros and file manager integration
# 5. Export decisions for cleanup automation
```

### CSV FORMAT COMPATIBILITY
This spreadsheet is specifically designed for CSV output from `czkawka_to_table.sh` with the following features:
- One row per duplicate relationship
- Separate folder/filename columns
- Focus on specific main directory
- Compatible with standard duplicate cleanup workflows

---

## DECISION MAKING WORKFLOW

### EFFICIENT PROCESSING STEPS
1. **Sort by file size** (Column E) - Handle large duplicates first
2. **For each row:**
   - Press **F3** to view both files in file manager
   - Compare files visually (content, modification dates, folder context)
   - Press **Ctrl+3** (keep original) or **Ctrl+4** (keep duplicate)
   - Cursor automatically moves to next row
3. **Use Ctrl+6** for files requiring more detailed analysis
4. **Periodically press Ctrl+7** to check progress statistics
5. **Use Ctrl+9** to filter and review specific decision types

### COLOR CODING SYSTEM
- **Green background:** Files marked to keep
- **Red background:** Files marked for deletion
- **Yellow background:** Files needing further review
- **No color:** Unprocessed files awaiting decision

---

## SUPPORT & UPDATES

### RELATED FILES
- `czkawkaDupFind.sh` - Duplicate scanner wrapper
- `czkawka_to_table.sh` - JSON to CSV converter
- `README.md` - Complete project documentation
- `use-help.txt` - Quick reference guide

### VERSION INFORMATION
- **Created:** July 2025
- **Last Updated:** August 2025  
- **Compatibility:** LibreOffice Calc 7.0+, Linux systems
- **Dependencies:** Czkawka CLI tools, jq, file managers (Nemo or Krusader)

For detailed technical documentation, see the project README.md file.
